doctype html
html(lang='en')
  head
    title Header with Buttons
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible',content='IE=edge')
    meta(name='description',content='')
    meta(name='viewport',content='initial-scale=1,maximum-scale=1,user-scalable=no')
    link(rel='stylesheet',href='/angular-material/angular-material.css')
    link(rel='stylesheet',href='http://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic')
    link(rel='stylesheet',href='https://fonts.googleapis.com/icon?family=Material+Icons')
    style.
      .divecard {
        margin: 16px;
        padding: 8px 24px;
        background-color: #039BE5;  /* Orange 800 */
      }

      .divecard.longest {
        background-color: #311B92;  /* Deep purple 900 */
      }

      .divecard.deepest {
        background-color: #6200EA;  /* Deep purple A700 */
      }

      .divecard h2 {
        color: white;
        font-weight: 500;
        font-size: 1.75em;
      }

      .divecard h1, .divecard h3 {
        font-weight: 200;
        color: #ECEFF1; /* Grey 50 */
      }

      .divecard h1 {
        font-size: 1.5em;
        margin: 0;
        margin-top: 16px;
      }

      .divecard h3 {
        margin: 0;
        font-size: 1.25em;
      }
  body(ng-app='myApp',layout='column',ng-controller='DiveLogController')
    div(layout='column',latout-fill)
      md-toolbar
        .md-toolbar-tools
          | My latest dives
          span(flex)
          md-icon border_color
          md-button(
            ng-click="displayAll()"
            ng-class="!showLongest && !showDeepest ? 'md-accent md-hue-1' : ''"
          ) None
          md-button(
            ng-click="displayLongest()"
            ng-class="showLongest ? 'md-accent md-hue-1' : ''"
          ) Longest
          md-button(
            ng-click="displayDeepest()"
            ng-class="showDeepest ? 'md-accent md-hue-1' : ''"
          ) Deepest
      md-content(flex)
        div(layout='row',layout-wrap)
          div(flex=33,ng-repeat='dive in dives')
            .divecard(ng-class='{longest: showLongest && longest === $index, deepest: showDeepest && deepest === $index}')
              h1 {{dive.site}}
              h3: small {{dive.location}}
              h2 {{dive.depth}} feet | {{dive.time}} min
      md-toolbar
        .md-toolbar-tools Powered by Angular Material
    script(src='/angular/angular.js')
    script(src='/angular-animate/angular-animate.js')
    script(src='/angular-aria/angular-aria.js')
    script(src='/angular-material/angular-material.js')
    script(type='text/javascript')
      :coffee-script
        angular
        .module 'dives', []
        .controller 'DiveLogController', [
          '$scope'
          ($scope) ->
            dives = [{
              site: "Abu Gotta Ramada"
              location: "Hurghada, Egypt"
              depth: 72
              time: 82
            },{
              site: "Ponte Mahoon"
              location: "MAehbourg, Mauritius"
              depth: 54
              time: 38
            },{
              site: "Molnar Cave"
              location: "Budapest, Hungary"
              depth: 98
              time: 62
            },{
              site: "Shark & Yolanda"
              location: "Ras Mohamed, Egypt"
              depth: 76
              time: 52
            }]
            longest = 0
            deepest = 0
            for dive, i in dives
              longest = i if dive.time > dives[longest].time
              deepest = i if dive.depth > dives[deepest].depth
            $scope.dives = dives
            $scope.longest = longest
            $scope.deepest = deepest

            $scope.displayAll = ->
              $scope.showLongest = false
              $scope.showDeepest = false
            $scope.displayLongest = ->
              $scope.showLongest = true
              $scope.showDeepest = false
            $scope.displayDeepest = ->
              $scope.showLongest = false
              $scope.showDeepest = true
            $scope.displayAll()
            true
        ]
        angular
        .module 'myApp', ['ngMaterial', 'dives']
        .config ($mdThemingProvider) ->
          $mdThemingProvider.theme 'default'
          .primaryPalette 'red'
          .accentPalette 'orange'
